<?xml version='1.0'?>

<policy xmlns="urn:jboss:security-config:4.1"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<!-- JNDI: java:/jaas/kipf.shop -->
    <application-policy name="kipf.shop">
       <authentication>
          <login-module code="org.jboss.security.auth.spi.DatabaseServerLoginModule"
                        flag="required">
             <module-option name="dsJndiName">java:/kipfDS</module-option>
             <module-option name="unauthenticatedIdentity">Gast</module-option>
             <module-option name="principalsQuery">SELECT passwort FROM shop.benutzer WHERE benutzername=?</module-option>
             <module-option name="rolesQuery">SELECT name, 'Roles' FROM shop.benutzergruppe b, shop.benutzer_gruppe bg WHERE	b.bg_id=bg.bg_id AND benutzername=?</module-option>
             <module-option name="hashAlgorithm">SHA-256</module-option>
             <module-option name="hashEncoding">base64</module-option>
          </login-module>
       </authentication>
    </application-policy>
</policy>
